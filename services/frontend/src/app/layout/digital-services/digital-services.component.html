<p-toast #toast position="bottom-center"></p-toast>
<div class="flex justify-content-between align-items-center flex-wrap mr-4 mb-4">
    <h1>
        {{
            isEcoMindAi
                ? ("eco-mind-ai.title" | translate: { WorkspaceName: selectedWorkspace })
                : ("digital-services.title"
                  | translate: { WorkspaceName: selectedWorkspace })
        }}
    </h1>
    <p-button
        styleClass="black-button matomo-add-digital-service"
        (onClick)="newDsSidebarVisible = true"
        *ngIf="
            ((userService.isAllowedDigitalServiceWrite$ | async) && !isEcoMindAi) ||
            ((userService.isAllowedEcoMindAiWrite$ | async) && isEcoMindAi)
        "
        id="add-digital"
    >
        {{
            isEcoMindAi
                ? ("eco-mind-ai.add" | translate)
                : ("digital-services.add" | translate)
        }}
    </p-button>
</div>
<p-scrollPanel [style]="{ width: '100%', height: 'calc(100vh - 260px)' }">
    <ul>
        @for (digitalService of paginatedDigitalServices; track $index) {
            <li>
                <app-digital-services-item
                    [isAi]="isEcoMindAi"
                    [digitalService]="digitalService"
                    (deleteUid)="itemDelete($event)"
                >
                </app-digital-services-item>
            </li>
        }
    </ul>
</p-scrollPanel>
@if (paginatedDigitalServices.length) {
    <p-paginator
        (onPageChange)="onPageChange($event)"
        [first]="first"
        [rows]="rowsPerPage"
        [totalRecords]="allDigitalServices.length"
        [rowsPerPageOptions]="[5, 10, 20, 50, 100]"
    />
}

@if (newDsSidebarVisible) {
    <p-sidebar
        [(visible)]="newDsSidebarVisible"
        position="right"
        styleClass="p-sidebar-md w-10"
        [showCloseIcon]="true"
        (onHide)="newDsSidebarVisible = false"
        ariaCloseLabel="Close"
    >
        <ng-template pTemplate="headless">
            <app-create-digital-services-sidebar
                [allDigitalServices]="allDigitalServices"
                (sidebarVisibleChange)="newDsSidebarVisible = $event"
                (submitCreateDsForm)="createNewDigitalServices($event)"
                [isEcoMindAi]="isEcoMindAi"
            />
        </ng-template>
    </p-sidebar>
}
